{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "9e87802f-2461-4371-b489-b9bbe58fc5cb",
   "metadata": {},
   "source": [
    "# Geometric data manipulations"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1eb5a35f",
   "metadata": {},
   "source": [
    "In this section we will use the Helsinki Region Travel Time Matrix data that constist of 13231 statistical grid squares (250m x 250m) to demonstrate some of the most common geometry manipulation functions available in geopandas. \n",
    "\n",
    "As the geometries in GeoDataFrames are eventually Shapely objects, we can use all of Shapely's tools for geometry manipulation directly via geopandas.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "62278989-accb-4a59-b6ee-7d31f98f6e75",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    POLYGON ((382000.000 6697750.000, 381750.000 6...\n",
       "1    POLYGON ((382250.000 6697750.000, 382000.000 6...\n",
       "2    POLYGON ((382500.000 6697750.000, 382250.000 6...\n",
       "3    POLYGON ((382750.000 6697750.000, 382500.000 6...\n",
       "4    POLYGON ((381250.000 6697500.000, 381000.000 6...\n",
       "Name: geometry, dtype: geometry"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import geopandas as gpd\n",
    "from pathlib import Path\n",
    "\n",
    "input_folder = Path(\"../data/Helsinki\")\n",
    "fp = input_folder / \"TravelTimes_to_5975375_RailwayStation.shp\"\n",
    "\n",
    "data = gpd.read_file(fp)\n",
    "\n",
    "data.geometry.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "f32e4fb2-9e2c-44c1-bcef-5191b415aa28",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Plot grid geometry"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e5fbcdae-5a13-4239-9988-c00d6ef7d96e",
   "metadata": {
    "tags": []
   },
   "source": [
    "## Centroid\n",
    "\n",
    "Extracting the centroid of geometric features is useful in a multitude of use cases. For example, the values in the Travel Time Matrix data set have originally been calculated from the center point of each grid square. We can find out the geometric centroid of each grid square in geopandas via the centroid-attribute:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "13e2a48e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0        POINT (381875.000 6697875.000)\n",
       "1        POINT (382125.000 6697875.000)\n",
       "2        POINT (382375.000 6697875.000)\n",
       "3        POINT (382625.000 6697875.000)\n",
       "4        POINT (381125.000 6697625.000)\n",
       "                      ...              \n",
       "13226    POINT (372875.000 6665625.000)\n",
       "13227    POINT (373125.000 6665625.000)\n",
       "13228    POINT (372375.000 6665375.000)\n",
       "13229    POINT (372625.000 6665375.000)\n",
       "13230    POINT (372875.000 6665375.000)\n",
       "Length: 13231, dtype: geometry"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Polygon centroids\n",
    "data.centroid"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "ea10f0dd-f15b-4624-a93c-9ea30e37130e",
   "metadata": {},
   "outputs": [],
   "source": [
    "# plot centroid geometries"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "efef7987",
   "metadata": {},
   "source": [
    "## Unary union\n",
    "\n",
    "Extracting only the outlines of the set of grid squares is possible through creating a geometric union among all geometries in the GeoDataFrame/GeoSeries. This could be useful, for example, when delineating the outlines of a study area."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "993def06",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"300\" height=\"300\" viewBox=\"359810.0001407551 6663560.000044268 45629.99999087548 36129.99999341555\" preserveAspectRatio=\"xMinYMin meet\"><g transform=\"matrix(1,0,0,-1,0,13363250.00008195)\"><g><path fill-rule=\"evenodd\" fill=\"#66cc99\" stroke=\"#555555\" stroke-width=\"304.1999999391699\" opacity=\"0.6\" d=\"M 363250.000140135,6676000.000042332 L 363250.00014012796,6676250.0000422895 L 363250.00014012016,6676500.000042246 L 363250.0001401146,6676750.000042201 L 363000.00014016294,6676750.000042209 L 362750.0001402115,6676750.000042216 L 362500.00014026184,6676750.000042223 L 362500.0001402546,6677000.00004218 L 362250.0001403041,6677000.000042191 L 362000.0001403532,6677000.000042194 L 362000.00014034606,6677250.00004215 L 361750.0001403957,6677250.000042158 L 361750.0001403885,6677500.000042114 L 361500.0001404374,6677500.000042123 L 361500.0001404307,6677750.000042075 L 361500.00014042354,6678000.000042033 L 361500.00014041713,6678250.00004199 L 361750.0001403669,6678250.000041983 L 361750.0001403602,6678500.00004194 L 362000.0001403109,6678500.000041934 L 362000.00014030444,6678750.000041891 L 362000.0001402969,6679000.000041845 L 362250.0001402473,6679000.0000418415 L 362250.0001402407,6679250.000041798 L 362500.00014019257,6679250.000041789 L 362500.00014018454,6679500.000041747 L 362750.0001401353,6679500.00004174 L 362750.0001401286,6679750.000041697 L 362750.00014012144,6680000.000041653 L 362750.0001401136,6680250.00004161 L 362750.00014010794,6680500.000041566 L 362750.0001401,6680750.000041523 L 362750.00014009327,6681000.000041479 L 362750.0001400864,6681250.000041435 L 362750.0001400789,6681500.00004139 L 362500.00014012796,6681500.000041396 L 362500.00014012214,6681750.000041358 L 362250.00014017103,6681750.000041362 L 362250.00014016393,6682000.000041321 L 362000.0001402134,6682000.000041326 L 362000.000140205,6682250.000041285 L 361750.0001402559,6682250.000041288 L 361750.00014024833,6682500.000041244 L 361750.0001402411,6682750.000041203 L 361750.00014023413,6683000.00004116 L 361750.0001402273,6683250.000041117 L 361750.0001402197,6683500.000041073 L 361750.00014021376,6683750.0000410285 L 361750.0001402067,6684000.0000409875 L 361750.0001401993,6684250.000040944 L 361750.00014019234,6684500.000040903 L 361750.0001401851,6684750.000040857 L 362000.00014013646,6684750.000040847 L 362000.0001401296,6685000.000040806 L 362250.00014008034,6685000.000040799 L 362250.0001400736,6685250.000040754 L 362500.0001400242,6685250.000040747 L 362500.0001400169,6685500.000040704 L 362500.00014001026,6685750.000040661 L 362250.0001400595,6685750.000040664 L 362000.00014010863,6685750.000040676 L 361750.0001401573,6685750.000040683 L 361750.0001401504,6686000.000040636 L 361750.00014014356,6686250.000040598 L 362000.00014009385,6686250.00004059 L 362000.0001400885,6686500.000040547 L 362250.00014003884,6686500.0000405405 L 362250.0001400318,6686750.000040497 L 362250.0001400247,6687000.000040451 L 362250.00014001713,6687250.000040407 L 362250.0001400114,6687500.000040369 L 362250.000140005,6687750.000040324 L 362250.0001399971,6688000.00004028 L 362000.0001400451,6688000.000040286 L 362000.00014003913,6688250.0000402415 L 362000.00014003273,6688500.000040201 L 362000.0001400255,6688750.000040154 L 362000.0001400181,6689000.000040113 L 362000.0001400114,6689250.000040069 L 362000.00014000485,6689500.000040027 L 362000.0001399967,6689750.000039984 L 362000.0001399908,6690000.000039939 L 361750.00014004007,6690000.000039948 L 361750.0001400332,6690250.000039904 L 361750.0001400259,6690500.000039859 L 362000.00013997714,6690500.000039854 L 362250.0001399279,6690500.000039848 L 362250.00013993494,6690250.000039892 L 362500.00013988535,6690250.000039883 L 362750.00013983616,6690250.0000398755 L 363000.00013978686,6690250.00003987 L 363000.0001397945,6690000.000039914 L 363250.00013974495,6690000.000039903 L 363500.0001396966,6690000.000039901 L 363500.00013970333,6689750.000039944 L 363750.0001396538,6689750.000039936 L 364000.00013960386,6689750.0000399295 L 364000.0001396115,6689500.0000399705 L 364250.0001395617,6689500.000039962 L 364500.0001395134,6689500.000039957 L 364750.0001394634,6689500.000039949 L 364750.000139471,6689250.000039993 L 365000.00013942155,6689250.0000399845 L 365250.0001393727,6689250.00003998 L 365250.0001393797,6689000.000040025 L 365500.00013933046,6689000.000040014 L 365500.00013932365,6689250.0000399705 L 365750.0001392742,6689250.000039965 L 365750.00013926765,6689500.000039921 L 366000.0001392191,6689500.000039914 L 366250.00013917004,6689500.000039911 L 366250.000139163,6689750.000039868 L 366500.0001391136,6689750.00003986 L 366750.00013906445,6689750.000039851 L 366750.0001390574,6690000.000039807 L 367000.0001390092,6690000.0000398 L 367250.0001389587,6690000.0000397945 L 367250.0001389524,6690250.000039751 L 367250.0001389454,6690500.000039709 L 367500.00013889687,6690500.000039703 L 367500.0001388899,6690750.00003966 L 367500.0001388835,6691000.000039617 L 367750.00013883394,6691000.000039606 L 367750.0001388267,6691250.000039564 L 367750.0001388199,6691500.000039519 L 368000.00013877056,6691500.00003951 L 368000.0001387643,6691750.000039469 L 368000.0001387574,6692000.00003943 L 368250.00013870804,6692000.000039421 L 368250.00013870234,6692250.00003938 L 368250.00013869465,6692500.0000393335 L 368250.0001386878,6692750.0000392925 L 368500.00013863924,6692750.000039287 L 368500.00013863144,6693000.000039243 L 368500.0001386251,6693250.000039199 L 368750.00013857667,6693250.000039191 L 368750.0001385691,6693500.000039151 L 368750.0001385624,6693750.00003911 L 369000.00013851386,6693750.000039103 L 369000.0001385063,6694000.000039055 L 369250.00013845775,6694000.000039049 L 369250.0001384643,6693750.000039092 L 369500.00013841584,6693750.0000390895 L 369750.0001383662,6693750.000039079 L 369750.0001383593,6694000.000039035 L 370000.0001383113,6694000.000039028 L 370250.000138262,6694000.000039022 L 370500.00013821316,6694000.000039014 L 370750.0001381638,6694000.000039007 L 370750.00013815693,6694250.000038966 L 371000.0001381085,6694250.000038957 L 371250.00013805844,6694250.000038951 L 371500.0001380098,6694250.000038946 L 371750.0001379608,6694250.000038939 L 371750.0001379674,6694000.00003898 L 371750.0001379741,6693750.000039024 L 372000.0001379256,6693750.000039018 L 372250.00013787684,6693750.000039009 L 372500.0001378282,6693750.000039004 L 372500.0001378348,6693500.000039045 L 372750.00013778557,6693500.000039039 L 373000.00013773714,6693500.000039033 L 373000.00013774383,6693250.000039075 L 373250.00013769366,6693250.000039069 L 373250.0001377014,6693000.00003911 L 373500.0001376518,6693000.000039104 L 373750.000137603,6693000.000039099 L 373750.00013760966,6692750.00003914 L 374000.0001375617,6692750.000039137 L 374250.0001375121,6692750.000039126 L 374250.0001375199,6692500.0000391705 L 374500.0001374694,6692500.000039161 L 374750.00013742165,6692500.0000391565 L 374750.0001374286,6692250.0000392 L 375000.00013737916,6692250.000039194 L 375250.0001373298,6692250.000039188 L 375250.00013733737,6692000.000039232 L 375500.0001372877,6692000.000039222 L 375500.00013729517,6691750.0000392655 L 375750.000137246,6691750.000039255 L 375750.00013724,6692000.000039214 L 376000.0001371911,6692000.000039208 L 376000.0001371837,6692250.000039168 L 376250.00013713475,6692250.000039158 L 376250.00013712764,6692500.000039117 L 376500.0001370788,6692500.000039108 L 376500.00013707276,6692750.000039064 L 376500.00013706565,6693000.000039023 L 376750.0001370159,6693000.000039014 L 376750.0001370094,6693250.000038974 L 377000.0001369609,6693250.0000389675 L 377000.0001369541,6693500.000038924 L 377250.00013690494,6693500.000038914 L 377250.0001368977,6693750.0000388725 L 377500.0001368503,6693750.000038868 L 377500.0001368429,6694000.000038824 L 377750.00013679423,6694000.000038815 L 377750.00013678754,6694250.000038777 L 377750.0001367802,6694500.000038731 L 378000.00013673224,6694500.000038726 L 378000.0001367263,6694750.0000386825 L 378250.000136676,6694750.000038674 L 378250.0001366699,6695000.000038629 L 378500.00013662025,6695000.000038622 L 378500.0001366141,6695250.000038583 L 378750.00013656536,6695250.000038573 L 378750.0001365575,6695500.00003853 L 378750.0001365517,6695750.000038488 L 379000.0001365027,6695750.00003848 L 379000.0001364957,6696000.0000384385 L 379250.0001364466,6696000.000038433 L 379250.0001364408,6696250.000038391 L 379500.00013639056,6696250.000038383 L 379500.0001363852,6696500.000038339 L 379750.0001363364,6696500.000038335 L 379750.0001363292,6696750.000038289 L 379750.0001363225,6697000.0000382485 L 380000.00013627415,6697000.00003824 L 380000.00013626774,6697250.000038196 L 380250.0001362179,6697250.000038191 L 380250.00013621163,6697500.000038148 L 380500.0001361625,6697500.000038142 L 380750.0001361137,6697500.000038133 L 381000.00013606605,6697500.0000381265 L 381000.00013605884,6697750.000038085 L 381250.0001360099,6697750.000038077 L 381500.0001359611,6697750.000038073 L 381750.0001359122,6697750.000038066 L 381750.00013590575,6698000.000038021 L 382000.0001358568,6698000.000038015 L 382250.0001358087,6698000.000038005 L 382500.0001357596,6698000.000038004 L 382750.0001357113,6698000.000037992 L 382750.0001357181,6697750.000038039 L 382750.0001357245,6697500.000038079 L 382750.0001357308,6697250.000038124 L 382750.0001357378,6697000.0000381665 L 383000.0001356888,6697000.000038159 L 383000.0001356958,6696750.000038205 L 383000.0001357022,6696500.000038247 L 383000.00013570953,6696250.000038289 L 383000.00013571494,6696000.000038333 L 383250.0001356669,6696000.000038323 L 383250.0001356741,6695750.000038371 L 383500.00013562496,6695750.000038361 L 383500.0001356314,6695500.000038404 L 383500.0001356383,6695250.000038447 L 383750.00013558986,6695250.000038442 L 383750.0001355976,6695000.000038481 L 384000.0001355476,6695000.000038475 L 384000.0001355546,6694750.0000385195 L 384250.00013550627,6694750.00003851 L 384250.00013551256,6694500.000038557 L 384250.0001355192,6694250.000038598 L 384500.00013547146,6694250.00003859 L 384500.00013547717,6694000.000038633 L 384750.0001354291,6694000.00003863 L 384750.0001354354,6693750.000038671 L 385000.0001353859,6693750.000038664 L 385000.0001353932,6693500.000038705 L 385000.0001353994,6693250.000038749 L 385250.0001353511,6693250.000038742 L 385250.0001353581,6693000.000038786 L 385250.0001353648,6692750.000038827 L 385500.0001353157,6692750.000038824 L 385500.0001353225,6692500.000038863 L 385750.000135274,6692500.000038858 L 385750.0001352805,6692250.0000389 L 385750.0001352883,6692000.000038945 L 386000.00013523875,6692000.000038939 L 386000.00013524515,6691750.000038983 L 386000.0001352519,6691500.000039023 L 386250.00013520406,6691500.000039016 L 386250.0001352102,6691250.00003906 L 386500.00013516215,6691250.000039051 L 386500.00013516843,6691000.000039097 L 386750.0001351186,6691000.000039089 L 386750.00013512676,6690750.000039133 L 387000.0001350773,6690750.000039122 L 387000.0001350846,6690500.0000391705 L 387250.000135035,6690500.000039162 L 387250.000135042,6690250.000039203 L 387500.0001349936,6690250.0000392 L 387750.0001349445,6690250.00003919 L 388000.0001348965,6690250.000039187 L 388250.00013484777,6690250.000039179 L 388500.000134798,6690250.000039174 L 388750.0001347493,6690250.000039162 L 389000.0001347015,6690250.000039157 L 389250.0001346534,6690250.000039149 L 389500.0001346043,6690250.0000391435 L 389750.00013455655,6690250.000039135 L 389750.00013454887,6690500.000039092 L 390000.00013449986,6690500.000039089 L 390250.0001344522,6690500.000039083 L 390250.0001344454,6690750.000039035 L 390500.0001343967,6690750.000039032 L 390750.0001343485,6690750.000039024 L 390750.0001343412,6691000.00003898 L 391000.0001342928,6691000.000038974 L 391250.0001342437,6691000.000038966 L 391250.0001342375,6691250.000038926 L 391500.0001341893,6691250.000038915 L 391750.0001341399,6691250.00003891 L 391750.00013413286,6691500.000038868 L 392000.00013408484,6691500.00003886 L 392000.00013407774,6691750.000038818 L 392000.00013407203,6692000.000038776 L 392000.00013406546,6692250.00003873 L 391750.00013411406,6692250.00003874 L 391750.00013410795,6692500.000038697 L 391500.0001341551,6692500.000038705 L 391500.00013414945,6692750.000038663 L 391500.0001341421,6693000.000038615 L 391250.000134191,6693000.000038623 L 391250.0001341839,6693250.00003858 L 391000.000134233,6693250.0000385875 L 391000.0001342274,6693500.000038546 L 391000.0001342193,6693750.000038501 L 390750.0001342679,6693750.00003851 L 390750.00013426115,6694000.0000384655 L 390750.00013425446,6694250.000038422 L 391000.0001342065,6694250.000038418 L 391000.0001342001,6694500.000038374 L 391250.0001341514,6694500.000038367 L 391500.00013410265,6694500.000038363 L 391750.0001340535,6694500.000038354 L 392000.00013400574,6694500.000038347 L 392000.00013401225,6694250.000038391 L 392250.0001339634,6694250.0000383835 L 392250.0001339575,6694500.00003834 L 392500.00013390766,6694500.000038333 L 392500.0001339017,6694750.000038292 L 392750.0001338531,6694750.000038284 L 393000.00013380486,6694750.000038277 L 393000.00013381185,6694500.000038323 L 393250.0001337633,6694500.000038315 L 393500.0001337151,6694500.000038309 L 393750.00013366586,6694500.000038303 L 393750.0001336604,6694750.000038257 L 394000.0001336105,6694750.000038249 L 394250.0001335621,6694750.000038242 L 394500.0001335142,6694750.000038238 L 394500.00013352075,6694500.000038283 L 394500.0001335277,6694250.000038326 L 394750.00013347913,6694250.000038318 L 394750.0001334854,6694000.000038359 L 394750.00013349176,6693750.000038402 L 395000.00013344403,6693750.000038397 L 395250.0001333949,6693750.000038389 L 395500.00013334624,6693750.000038383 L 395750.00013329793,6693750.000038377 L 396000.00013324985,6693750.00003837 L 396250.00013320136,6693750.000038365 L 396250.0001332077,6693500.000038406 L 396250.00013321446,6693250.000038446 L 396500.0001331661,6693250.000038441 L 396750.00013311836,6693250.000038435 L 396750.00013312406,6693000.000038476 L 397000.00013307633,6693000.000038471 L 397250.0001330275,6693000.000038463 L 397500.000132979,6693000.000038457 L 397750.0001329312,6693000.0000384515 L 398000.00013288175,6693000.000038444 L 398250.0001328343,6693000.000038436 L 398250.0001328408,6692750.000038481 L 398000.00013288914,6692750.00003849 L 398000.0001328958,6692500.000038531 L 397750.00013294385,6692500.000038536 L 397750.00013295055,6692250.00003858 L 397750.0001329577,6692000.000038624 L 397500.0001330061,6692000.000038632 L 397500.0001330126,6691750.000038672 L 397500.00013301865,6691500.000038718 L 397750.00013297,6691500.000038706 L 398000.00013292197,6691500.000038703 L 398250.0001328738,6691500.000038697 L 398250.0001328796,6691250.000038736 L 398250.0001328866,6691000.000038781 L 398000.0001329342,6691000.00003879 L 398000.00013294147,6690750.000038829 L 398000.00013294857,6690500.000038876 L 398000.00013295515,6690250.000038915 L 397750.0001330029,6690250.000038921 L 397500.0001330517,6690250.000038931 L 397500.0001330586,6690000.00003897 L 397250.00013310637,6690000.000038979 L 397000.0001331558,6690000.000038988 L 396750.0001332038,6690000.000038997 L 396500.0001332521,6690000.000038997 L 396250.00013330113,6690000.0000390075 L 396250.0001332932,6690250.000038962 L 396000.0001333428,6690250.000038965 L 395750.0001333911,6690250.000038976 L 395500.000133439,6690250.000038983 L 395500.0001334471,6690000.000039026 L 395750.0001333979,6690000.000039019 L 395750.0001334043,6689750.00003906 L 396000.00013335573,6689750.000039059 L 396000.0001333633,6689500.000039098 L 396250.0001333132,6689500.0000390895 L 396500.0001332662,6689500.000039084 L 396500.00013327255,6689250.000039128 L 396750.000133224,6689250.00003912 L 396750.00013323047,6689000.000039166 L 397000.0001331817,6689000.000039157 L 397000.000133189,6688750.000039199 L 397250.00013314025,6688750.000039194 L 397250.0001331467,6688500.000039237 L 397500.0001330982,6688500.000039229 L 397750.000133049,6688500.000039223 L 397750.00013305654,6688250.000039265 L 398000.0001330077,6688250.000039259 L 398250.00013295986,6688250.000039253 L 398250.00013296655,6688000.000039294 L 398500.0001329178,6688000.00003929 L 398500.0001329249,6687750.00003933 L 398750.0001328764,6687750.000039322 L 399000.0001328279,6687750.000039317 L 399000.0001328348,6687500.000039358 L 399250.000132785,6687500.000039354 L 399250.0001327927,6687250.000039399 L 399250.00013279903,6687000.000039439 L 399500.0001327505,6687000.000039433 L 399500.0001327575,6686750.000039477 L 399500.0001327635,6686500.000039519 L 399750.0001327157,6686500.00003951 L 399750.0001327224,6686250.000039556 L 399750.00013272936,6686000.000039598 L 400000.0001326811,6686000.000039592 L 400000.0001326868,6685750.000039635 L 400250.0001326387,6685750.00003963 L 400250.00013264583,6685500.000039671 L 400250.0001326525,6685250.0000397125 L 400250.0001326591,6685000.000039758 L 400250.00013266585,6684750.000039798 L 400250.00013267226,6684500.000039842 L 400500.0001326224,6684500.000039836 L 400500.0001326171,6684750.000039795 L 400500.00013260933,6685000.000039751 L 400750.00013256207,6685000.000039745 L 401000.0001325129,6685000.000039739 L 401000.00013250683,6685250.000039695 L 401250.00013245904,6685250.000039689 L 401500.00013240986,6685250.00003968 L 401500.00013240334,6685500.000039635 L 401750.0001323561,6685500.000039632 L 401750.0001323483,6685750.000039587 L 402000.0001323002,6685750.00003958 L 402000.0001322941,6686000.000039537 L 402250.0001322455,6686000.000039535 L 402500.0001321975,6686000.000039524 L 402500.0001322033,6685750.000039568 L 402750.0001321555,6685750.000039562 L 403000.000132107,6685750.000039556 L 403000.0001321011,6686000.000039513 L 403250.00013205264,6686000.000039505 L 403500.0001320037,6686000.000039496 L 403500.0001320105,6685750.00003954 L 403750.0001319627,6685750.000039535 L 403750.0001319685,6685500.00003958 L 403500.0001320162,6685500.000039587 L 403500.000132023,6685250.000039625 L 403500.0001320304,6685000.000039671 L 403500.0001320366,6684750.000039714 L 403500.0001320436,6684500.000039755 L 403250.00013209134,6684500.000039766 L 403250.0001320987,6684250.000039805 L 403250.0001321047,6684000.0000398485 L 403250.00013211166,6683750.000039891 L 403250.000132118,6683500.000039936 L 403500.0001320703,6683500.0000399295 L 403500.00013207673,6683250.0000399705 L 403500.0001320834,6683000.000040014 L 403250.0001321317,6683000.00004002 L 403000.00013218046,6683000.000040031 L 403000.000132186,6682750.000040068 L 402750.00013223523,6682750.000040077 L 402500.000132283,6682750.000040082 L 402500.0001322902,6682500.000040129 L 402250.0001323391,6682500.000040135 L 402250.0001323447,6682250.000040176 L 402250.0001323521,6682000.000040219 L 402250.00013235724,6681750.00004026 L 402250.00013236515,6681500.0000403095 L 402500.00013231597,6681500.000040301 L 402500.0001323227,6681250.000040339 L 402750.0001322754,6681250.000040336 L 402750.0001322818,6681000.0000403775 L 402750.00013228826,6680750.000040423 L 402500.000132337,6680750.000040429 L 402500.00013234303,6680500.000040467 L 402500.0001323506,6680250.000040516 L 402250.00013239804,6680250.000040519 L 402000.00013244746,6680250.000040529 L 402000.0001324526,6680000.000040571 L 401750.0001325015,6680000.000040576 L 401500.0001325496,6680000.000040582 L 401500.0001325564,6679750.000040626 L 401500.00013256364,6679500.00004067 L 401750.0001325158,6679500.000040664 L 402000.0001324672,6679500.000040658 L 402000.0001324732,6679250.000040699 L 401750.00013252115,6679250.000040705 L 401750.00013252825,6679000.000040751 L 401500.0001325768,6679000.000040757 L 401500.0001325834,6678750.0000408 L 401250.0001326321,6678750.000040803 L 401250.0001326395,6678500.00004085 L 401000.0001326875,6678500.000040855 L 400750.00013273535,6678500.000040862 L 400750.000132742,6678250.000040908 L 400500.00013279007,6678250.000040915 L 400500.0001327839,6678500.00004087 L 400500.00013277645,6678750.000040824 L 400250.00013282563,6678750.000040833 L 400250.0001328312,6678500.000040876 L 400000.0001328805,6678500.000040887 L 400000.00013288786,6678250.000040926 L 400000.0001328938,6678000.000040969 L 399750.0001329424,6678000.0000409745 L 399500.00013299123,6678000.000040983 L 399500.00013299834,6677750.000041027 L 399500.0001330042,6677500.000041068 L 399750.00013295654,6677500.000041065 L 400000.0001329073,6677500.0000410555 L 400250.0001328587,6677500.000041049 L 400250.000132866,6677250.000041094 L 400250.00013287214,6677000.000041135 L 400500.00013282313,6677000.000041125 L 400500.0001328314,6676750.000041168 L 400500.00013283733,6676500.000041214 L 400250.0001328862,6676500.00004122 L 400250.0001328931,6676250.000041264 L 400000.0001329408,6676250.000041272 L 400000.00013294746,6676000.000041311 L 399750.0001329958,6676000.000041321 L 399500.0001330444,6676000.000041328 L 399250.00013309193,6676000.000041337 L 399250.0001331003,6675750.000041378 L 399250.00013310695,6675500.000041424 L 399500.00013305753,6675500.000041413 L 399500.0001330655,6675250.000041457 L 399750.00013301615,6675250.000041449 L 399750.00013302284,6675000.000041495 L 399500.0001330722,6675000.000041501 L 399500.00013307744,6674750.000041544 L 399250.00013312703,6674750.000041552 L 399250.0001331329,6674500.00004159 L 399250.0001331403,6674250.000041638 L 399250.000133147,6674000.000041679 L 399000.000133196,6674000.000041687 L 398750.00013324426,6674000.000041692 L 398750.00013323704,6674250.000041649 L 398750.00013323093,6674500.00004161 L 398500.00013328006,6674500.000041613 L 398250.00013332797,6674500.000041623 L 398250.00013332145,6674750.000041579 L 398000.00013336993,6674750.0000415845 L 398000.00013336306,6675000.000041542 L 397750.0001334116,6675000.00004155 L 397500.0001334596,6675000.0000415575 L 397250.00013350835,6675000.000041563 L 397000.00013355655,6675000.00004157 L 397000.00013356324,6674750.000041608 L 397250.0001335144,6674750.000041605 L 397500.0001334659,6674750.000041598 L 397750.0001334183,6674750.000041587 L 397750.0001334245,6674500.000041635 L 397750.00013343175,6674250.000041678 L 397500.0001334797,6674250.000041689 L 397500.00013348635,6674000.000041727 L 397500.0001334938,6673750.000041775 L 397500.00013350026,6673500.0000418145 L 397750.000133452,6673500.000041809 L 397750.00013345917,6673250.000041852 L 397500.0001335076,6673250.000041858 L 397250.00013355544,6673250.000041867 L 397250.00013354863,6673500.000041822 L 397000.00013359776,6673500.000041828 L 396750.000133646,6673500.000041836 L 396750.0001336388,6673750.000041789 L 396500.00013368763,6673750.000041801 L 396250.0001337362,6673750.000041805 L 396250.0001337294,6674000.000041762 L 396250.0001337229,6674250.000041717 L 396250.0001337154,6674500.000041675 L 396250.00013370987,6674750.000041632 L 396000.0001337578,6674750.000041637 L 396000.00013376394,6674500.000041681 L 395750.000133813,6674500.000041689 L 395750.0001338206,6674250.000041733 L 395500.00013386883,6674250.00004174 L 395500.00013386254,6674500.000041696 L 395250.0001339097,6674500.000041703 L 395250.00013391767,6674250.000041749 L 395000.00013396575,6674250.000041752 L 394750.0001340141,6674250.00004176 L 394750.00013402075,6674000.000041802 L 394500.00013406994,6674000.000041811 L 394500.00013407675,6673750.0000418555 L 394250.0001341251,6673750.000041857 L 394000.0001341743,6673750.000041864 L 394000.0001341667,6674000.000041823 L 394000.00013416016,6674250.000041782 L 394000.0001341535,6674500.000041737 L 394250.0001341053,6674500.000041726 L 394250.00013409794,6674750.000041688 L 394500.00013404887,6674750.000041679 L 394750.0001340013,6674750.000041673 L 394750.00013399485,6675000.000041635 L 394500.00013404293,6675000.000041634 L 394500.0001340358,6675250.000041593 L 394250.0001340848,6675250.000041599 L 394000.0001341329,6675250.000041606 L 393750.00013418193,6675250.000041614 L 393750.0001341879,6675000.000041658 L 393500.00013423746,6675000.000041664 L 393250.00013428566,6675000.00004167 L 393000.0001343351,6675000.000041678 L 393000.00013434206,6674750.00004172 L 393250.000134293,6674750.000041716 L 393250.0001342996,6674500.000041757 L 393250.00013430556,6674250.000041802 L 393000.0001343549,6674250.000041806 L 393000.0001343618,6674000.000041855 L 392750.00013441045,6674000.000041857 L 392750.0001344171,6673750.000041898 L 392750.00013442384,6673500.000041944 L 392750.0001344305,6673250.000041988 L 392750.00013443734,6673000.000042029 L 392750.00013444526,6672750.0000420725 L 392750.00013445143,6672500.00004212 L 392750.0001344574,6672250.000042158 L 393000.0001344091,6672250.000042153 L 393250.000134361,6672250.000042149 L 393500.0001343116,6672250.000042139 L 393750.0001342633,6672250.000042134 L 394000.0001342145,6672250.000042126 L 394000.00013422186,6672000.000042171 L 394250.00013417343,6672000.000042163 L 394250.0001341796,6671750.000042207 L 394250.0001341867,6671500.000042252 L 394500.00013413787,6671500.00004224 L 394500.0001341448,6671250.000042286 L 394500.0001341525,6671000.000042327 L 394250.0001342002,6671000.000042337 L 394250.00013420713,6670750.000042379 L 394250.0001342132,6670500.000042423 L 394000.0001342624,6670500.000042428 L 393750.0001343108,6670500.000042436 L 393750.00013431796,6670250.000042482 L 393750.0001343244,6670000.000042525 L 393500.00013437384,6670000.000042531 L 393500.00013437984,6669750.0000425745 L 393500.0001343869,6669500.000042618 L 393750.0001343384,6669500.000042611 L 393750.0001343451,6669250.000042652 L 393750.00013435184,6669000.000042696 L 393500.0001344004,6669000.000042703 L 393250.0001344483,6669000.000042708 L 393000.00013449765,6669000.000042719 L 392750.0001345468,6669000.000042727 L 392500.0001345958,6669000.000042733 L 392250.000134644,6669000.0000427365 L 392250.00013465085,6668750.000042781 L 392500.0001346022,6668750.000042775 L 392500.00013460964,6668500.000042819 L 392750.00013455976,6668500.00004281 L 392750.0001345667,6668250.000042858 L 392500.0001346164,6668250.0000428585 L 392500.00013462343,6668000.000042901 L 392250.000134672,6668000.00004291 L 392000.0001347202,6668000.000042921 L 391750.0001347685,6668000.000042925 L 391500.0001348173,6668000.000042927 L 391250.0001348666,6668000.0000429405 L 391000.0001349143,6668000.000042943 L 391000.00013492256,6667750.00004299 L 390750.00013497006,6667750.000042995 L 390500.0001350202,6667750.000043005 L 390500.0001350132,6668000.000042962 L 390500.0001350054,6668250.000042913 L 390500.0001349991,6668500.000042872 L 390500.00013499305,6668750.000042828 L 390750.0001349433,6668750.000042822 L 390750.0001349363,6669000.000042777 L 390500.0001349859,6669000.000042787 L 390250.00013503444,6669000.000042792 L 390250.00013502664,6669250.00004275 L 390500.000134978,6669250.000042743 L 390500.0001349717,6669500.000042697 L 390500.0001349646,6669750.000042655 L 390750.0001349159,6669750.000042646 L 391000.0001348674,6669750.000042643 L 391000.0001348604,6670000.000042599 L 391000.00013485365,6670250.000042559 L 391250.0001348057,6670250.000042549 L 391250.00013479794,6670500.000042504 L 391500.0001347486,6670500.000042496 L 391500.00013474154,6670750.000042454 L 391250.00013479113,6670750.00004246 L 391250.0001347843,6671000.000042417 L 391000.00013483356,6671000.000042427 L 391000.0001348398,6670750.000042469 L 390750.000134889,6670750.0000424795 L 390500.0001349371,6670750.000042482 L 390500.00013493025,6671000.00004244 L 390500.00013492384,6671250.000042397 L 390500.00013491744,6671500.000042354 L 390250.0001349662,6671500.000042359 L 390000.000135014,6671500.000042362 L 390000.00013502064,6671250.000042408 L 390000.0001350281,6671000.000042455 L 390000.0001350354,6670750.000042498 L 389750.0001350831,6670750.000042501 L 389500.00013513234,6670750.000042514 L 389500.00013512495,6671000.0000424655 L 389500.0001351186,6671250.000042423 L 389500.00013511267,6671500.000042381 L 389500.0001351051,6671750.000042334 L 389500.00013509777,6672000.000042293 L 389500.0001350921,6672250.000042253 L 389500.0001350848,6672500.000042206 L 389750.00013503624,6672500.000042198 L 389750.0001350286,6672750.000042154 L 390000.00013498025,6672750.000042149 L 390000.0001349731,6673000.000042111 L 389750.00013502187,6673000.0000421135 L 389500.0001350708,6673000.000042122 L 389250.00013511983,6673000.000042129 L 389000.0001351688,6673000.000042135 L 388750.00013521797,6673000.0000421405 L 388750.00013522344,6672750.000042181 L 388750.0001352314,6672500.000042229 L 388500.00013527885,6672500.000042231 L 388500.00013528677,6672250.000042277 L 388500.0001352931,6672000.000042318 L 388250.00013534195,6672000.000042327 L 388000.00013539084,6672000.000042335 L 388000.00013539795,6671750.000042379 L 388000.0001354044,6671500.00004242 L 387750.00013545377,6671500.000042429 L 387750.00013546075,6671250.00004247 L 387500.0001355095,6671250.000042476 L 387250.0001355574,6671250.000042485 L 387000.0001356066,6671250.000042493 L 387000.0001355996,6671500.000042449 L 386750.00013564865,6671500.000042457 L 386750.000135656,6671250.000042495 L 386750.0001356631,6671000.000042544 L 386750.00013566983,6670750.000042585 L 387000.00013562024,6670750.000042582 L 387000.00013562717,6670500.000042621 L 387000.00013563497,6670250.000042668 L 386750.00013568345,6670250.000042672 L 386500.00013573194,6670250.000042681 L 386500.0001357255,6670500.000042637 L 386250.0001357738,6670500.000042647 L 386250.00013577985,6670250.000042685 L 386000.000135829,6670250.000042691 L 385750.00013587833,6670250.0000426965 L 385500.0001359283,6670250.000042708 L 385250.0001359767,6670250.000042716 L 385250.000135983,6670000.000042757 L 385250.00013599056,6669750.000042805 L 385000.00013603945,6669750.000042806 L 385000.0001360457,6669500.000042847 L 384750.0001360951,6669500.000042855 L 384500.00013614335,6669500.000042863 L 384250.0001361927,6669500.000042872 L 384250.0001361852,6669750.000042828 L 384250.00013617857,6670000.000042785 L 384000.00013622723,6670000.000042794 L 384000.0001362342,6669750.000042835 L 383750.00013628404,6669750.000042844 L 383750.0001362767,6670000.0000428 L 383750.00013626926,6670250.000042754 L 383500.0001363184,6670250.00004276 L 383500.0001363116,6670500.000042721 L 383500.00013630465,6670750.000042677 L 383500.000136298,6671000.000042632 L 383500.0001362914,6671250.00004259 L 383250.0001363389,6671250.000042597 L 383250.00013634673,6671000.000042639 L 383250.0001363539,6670750.0000426825 L 383250.0001363605,6670500.000042724 L 383250.00013636687,6670250.00004277 L 383250.0001363738,6670000.000042812 L 383250.0001363809,6669750.000042858 L 383000.00013643014,6669750.000042866 L 383000.0001364369,6669500.000042907 L 383000.00013644446,6669250.000042951 L 382750.0001364934,6669250.000042958 L 382500.00013654126,6669250.000042965 L 382250.00013658986,6669250.000042969 L 382000.0001366396,6669250.00004298 L 381750.0001366888,6669250.000042985 L 381750.00013668195,6669500.000042941 L 381750.00013667345,6669750.000042897 L 382000.000136625,6669750.000042891 L 382000.00013661815,6670000.000042845 L 381750.0001366685,6670000.000042855 L 381750.0001366613,6670250.000042811 L 381500.0001367096,6670250.000042819 L 381250.0001367585,6670250.000042825 L 381250.00013676553,6670000.000042869 L 381000.00013681507,6670000.000042876 L 381000.0001368079,6670250.000042832 L 380750.0001368562,6670250.000042839 L 380750.0001368497,6670500.000042797 L 380750.00013684295,6670750.000042749 L 380750.0001368356,6671000.0000427095 L 380750.0001368291,6671250.000042667 L 380500.0001368779,6671250.000042672 L 380250.000136927,6671250.000042678 L 380250.0001369197,6671500.000042637 L 380000.0001369687,6671500.0000426425 L 379750.00013701787,6671500.00004265 L 379750.0001370112,6671750.000042607 L 379500.0001370601,6671750.000042613 L 379250.00013710925,6671750.000042621 L 379250.0001371026,6672000.000042577 L 379000.000137151,6672000.000042585 L 378750.00013720046,6672000.000042592 L 378500.000137249,6672000.000042595 L 378500.000137256,6671750.0000426425 L 378500.00013726257,6671500.000042685 L 378250.0001373119,6671500.000042688 L 378250.0001373188,6671250.000042735 L 378000.0001373678,6671250.00004274 L 378000.00013737526,6671000.000042787 L 377750.0001374238,6671000.000042794 L 377500.0001374724,6671000.000042798 L 377500.0001374812,6670750.000042844 L 377250.00013752864,6670750.000042849 L 377000.0001375777,6670750.000042857 L 377000.00013758545,6670500.000042901 L 376750.00013763335,6670500.000042909 L 376500.0001376836,6670500.000042914 L 376250.0001377333,6670500.000042923 L 376250.0001377385,6670250.000042967 L 376250.0001377458,6670000.000043008 L 376000.00013779546,6670000.000043016 L 375750.00013784395,6670000.000043024 L 375500.00013789395,6670000.00004303 L 375500.0001379004,6669750.000043075 L 375250.00013794954,6669750.000043078 L 375250.00013795623,6669500.000043124 L 375000.0001380064,6669500.0000431305 L 374750.0001380546,6669500.000043138 L 374500.00013810385,6669500.000043146 L 374500.0001381107,6669250.00004319 L 374250.00013816054,6669250.000043198 L 374250.0001381527,6669500.000043154 L 374000.0001382022,6669500.000043159 L 374000.00013819535,6669750.000043118 L 374000.00013818784,6670000.000043073 L 373750.00013823714,6670000.00004308 L 373500.00013828615,6670000.000043089 L 373500.00013829395,6669750.000043127 L 373250.0001383423,6669750.000043136 L 373250.00013834995,6669500.000043181 L 373000.0001383996,6669500.000043189 L 373000.00013840507,6669250.00004323 L 372750.00013845426,6669250.000043237 L 372500.0001385042,6669250.000043244 L 372250.0001385533,6669250.00004325 L 372000.00013860274,6669250.000043263 L 372000.00013860926,6669000.000043305 L 372250.00013855996,6669000.000043293 L 372250.0001385672,6668750.000043342 L 372500.0001385184,6668750.0000433335 L 372500.0001385246,6668500.000043375 L 372750.0001384753,6668500.000043367 L 373000.00013842696,6668500.000043362 L 373250.0001383767,6668500.000043354 L 373250.0001383705,6668750.000043313 L 373500.0001383206,6668750.000043305 L 373750.0001382724,6668750.000043295 L 374000.0001382225,6668750.000043289 L 374000.00013822946,6668500.0000433335 L 374250.00013818033,6668500.000043326 L 374250.0001381883,6668250.00004337 L 374250.00013819523,6668000.000043416 L 374250.0001382018,6667750.000043456 L 374500.0001381526,6667750.000043449 L 374750.0001381041,6667750.000043442 L 374750.0001381105,6667500.000043487 L 374750.0001381181,6667250.00004353 L 374750.0001381246,6667000.000043577 L 374500.0001381738,6667000.000043582 L 374500.0001381813,6666750.000043623 L 374250.00013823016,6666750.0000436315 L 374250.00013823714,6666500.000043677 L 374000.0001382867,6666500.000043681 L 374000.00013829285,6666250.000043727 L 374000.0001382994,6666000.000043766 L 373750.0001383488,6666000.000043773 L 373500.00013839843,6666000.000043785 L 373500.0001384054,6665750.000043827 L 373250.0001384545,6665750.000043833 L 373250.00013846194,6665500.00004388 L 373000.00013851107,6665500.000043886 L 373000.00013851776,6665250.00004393 L 372750.0001385672,6665250.000043934 L 372500.000138616,6665250.000043942 L 372250.0001386649,6665250.000043948 L 372250.00013865775,6665500.000043907 L 372250.00013865106,6665750.000043863 L 372250.0001386449,6666000.000043818 L 372000.0001386931,6666000.0000438215 L 371750.0001387433,6666000.0000438355 L 371750.0001387492,6665750.0000438765 L 371500.00013879914,6665750.000043883 L 371500.00013879244,6666000.000043839 L 371500.00013878505,6666250.0000437945 L 371250.00013883377,6666250.000043804 L 371250.0001388276,6666500.00004376 L 371000.00013887574,6666500.00004377 L 370750.00013892585,6666500.000043773 L 370500.00013897417,6666500.0000437815 L 370500.00013896736,6666750.000043738 L 370500.0001389608,6667000.000043692 L 370250.0001390099,6667000.000043701 L 370250.00013900275,6667250.000043659 L 370250.0001389957,6667500.000043616 L 370250.00013898796,6667750.000043568 L 370000.000139038,6667750.000043577 L 370000.0001390307,6668000.000043534 L 370000.000139024,6668250.00004349 L 370000.00013901596,6668500.000043445 L 369750.0001390667,6668500.000043456 L 369750.00013905985,6668750.000043413 L 369500.00013910857,6668750.000043419 L 369500.00013911567,6668500.000043463 L 369250.0001391643,6668500.000043468 L 369250.00013915694,6668750.000043421 L 369250.0001391503,6669000.000043378 L 369000.0001391993,6669000.000043386 L 368750.00013924856,6669000.000043396 L 368750.00013924163,6669250.000043353 L 368750.0001392346,6669500.0000433065 L 368750.00013922737,6669750.0000432655 L 368500.0001392771,6669750.000043271 L 368500.00013926986,6670000.000043228 L 368500.0001392632,6670250.000043186 L 368500.000139256,6670500.000043137 L 368250.00013930467,6670500.000043145 L 368250.00013929745,6670750.000043107 L 368000.00013934646,6670750.000043111 L 368000.00013934,6671000.000043069 L 367750.0001393892,6671000.0000430755 L 367500.00013943866,6671000.000043083 L 367250.0001394874,6671000.000043089 L 367250.0001394808,6671250.000043048 L 367000.00013952976,6671250.000043052 L 366750.00013957947,6671250.000043059 L 366750.00013957266,6671500.000043018 L 367000.0001395232,6671500.000043011 L 367250.00013947394,6671500.000043002 L 367250.0001394667,6671750.00004296 L 367000.0001395155,6671750.000042964 L 367000.00013950863,6672000.000042922 L 366750.0001395579,6672000.000042929 L 366750.0001395653,6671750.000042971 L 366500.0001396141,6671750.00004298 L 366500.000139622,6671500.000043025 L 366250.00013967056,6671500.000043032 L 366250.0001396636,6671750.000042984 L 366000.00013971236,6671750.000042993 L 366000.0001397056,6672000.000042949 L 366250.00013965694,6672000.000042943 L 366250.0001396496,6672250.0000429 L 366250.00013964286,6672500.000042859 L 366000.00013969146,6672500.000042865 L 366000.0001396991,6672250.000042908 L 365750.00013974775,6672250.000042912 L 365750.0001397404,6672500.000042871 L 365500.00013979024,6672500.000042878 L 365500.0001397829,6672750.000042832 L 365500.0001397765,6673000.000042791 L 365500.0001397686,6673250.000042745 L 365250.00013981794,6673250.000042755 L 365000.0001398679,6673250.000042762 L 365000.000139861,6673500.000042717 L 365000.0001398534,6673750.000042676 L 364750.000139904,6673750.00004268 L 364750.0001398957,6674000.000042638 L 364500.00013994507,6674000.000042646 L 364250.0001399941,6674000.000042655 L 364250.0001399871,6674250.000042608 L 364250.0001399801,6674500.000042562 L 364000.0001400297,6674500.000042574 L 364000.00014002196,6674750.00004253 L 363750.0001400721,6674750.00004254 L 363500.0001401209,6674750.000042542 L 363500.0001401134,6675000.000042496 L 363250.00014016323,6675000.0000425065 L 363250.000140156,6675250.000042463 L 363000.0001402051,6675250.000042469 L 363000.0001401986,6675500.000042427 L 362750.00014024787,6675500.000042434 L 362500.0001402971,6675500.000042442 L 362500.00014029,6675750.000042396 L 362250.0001403382,6675750.000042403 L 362250.00014033215,6676000.000042359 L 362500.0001402828,6676000.000042351 L 362750.0001402338,6676000.000042348 L 363000.00014018477,6676000.0000423435 L 363250.000140135,6676000.000042332 z M 388000.0001353839,6672250.000042291 L 387750.0001354321,6672250.0000423 L 387750.0001354404,6672000.000042341 L 388000.00013539084,6672000.000042335 L 388000.0001353839,6672250.000042291 z M 387750.00013542577,6672500.000042256 L 387500.0001354747,6672500.000042262 L 387500.0001354817,6672250.0000423025 L 387750.0001354321,6672250.0000423 L 387750.00013542577,6672500.000042256 z M 387250.00013553025,6672250.000042313 L 387250.0001355377,6672000.000042354 L 387500.000135489,6672000.000042348 L 387500.0001354817,6672250.0000423025 L 387250.00013553025,6672250.000042313 z M 381000.0001366621,6675500.000041922 L 381000.00013665674,6675750.000041882 L 380750.0001367045,6675750.000041883 L 380500.0001367545,6675750.000041895 L 380500.00013674644,6676000.000041848 L 380250.00013679534,6676000.000041855 L 380000.0001368442,6676000.000041863 L 380000.000136838,6676250.000041818 L 379750.00013688655,6676250.000041824 L 379750.00013689336,6676000.00004187 L 379750.0001369003,6675750.000041913 L 379750.0001369079,6675500.000041957 L 379500.00013695675,6675500.000041961 L 379250.00013700576,6675500.000041969 L 379250.00013701187,6675250.000042015 L 379000.0001370617,6675250.000042022 L 379000.00013706804,6675000.000042066 L 379000.00013707497,6674750.000042107 L 379250.00013702665,6674750.000042101 L 379500.0001369775,6674750.000042093 L 379500.0001369702,6675000.000042048 L 379750.000136922,6675000.000042047 L 380000.00013687287,6675000.000042037 L 380250.0001368245,6675000.0000420315 L 380250.0001368307,6674750.0000420725 L 380500.000136781,6674750.000042066 L 380500.0001367882,6674500.000042113 L 380500.00013679545,6674250.000042151 L 380250.00013684423,6674250.000042157 L 380250.0001368507,6674000.000042203 L 380250.0001368579,6673750.0000422485 L 380500.00013680884,6673750.000042239 L 380500.00013680226,6674000.000042193 L 380750.0001367527,6674000.000042187 L 381000.0001367043,6674000.000042179 L 381000.0001366981,6674250.000042138 L 381250.0001366489,6674250.000042127 L 381250.000136642,6674500.000042088 L 381500.00013659254,6674500.000042083 L 381750.00013654394,6674500.000042077 L 381750.0001365377,6674750.000042031 L 381750.00013652886,6675000.000041987 L 381750.00013652403,6675250.000041945 L 381500.0001365716,6675250.00004195 L 381250.0001366205,6675250.000041957 L 381250.00013661437,6675500.000041916 L 381000.0001366621,6675500.000041922 z M 381250.0001366826,6673000.000042345 L 381500.00013663486,6673000.000042345 L 381500.0001366405,6672750.000042384 L 381750.00013659184,6672750.000042374 L 382000.00013654283,6672750.000042371 L 382000.0001365496,6672500.000042415 L 382000.00013655657,6672250.00004246 L 381750.00013660546,6672250.000042467 L 381500.0001366546,6672250.000042473 L 381500.00013666216,6672000.000042512 L 381500.0001366689,6671750.0000425605 L 381750.0001366193,6671750.00004255 L 382000.0001365704,6671750.000042545 L 382250.0001365215,6671750.0000425335 L 382250.0001365141,6672000.000042494 L 382500.00013646606,6672000.000042487 L 382750.00013641705,6672000.000042481 L 382750.0001364242,6671750.000042524 L 383000.0001363747,6671750.000042517 L 383250.00013632607,6671750.0000425065 L 383250.0001363189,6672000.0000424655 L 383500.0001362702,6672000.00004246 L 383500.00013626344,6672250.000042415 L 383250.0001363116,6672250.000042424 L 383250.00013630564,6672500.000042383 L 383500.0001362564,6672500.000042368 L 383500.0001362497,6672750.000042329 L 383750.0001362011,6672750.00004232 L 383750.0001361937,6673000.000042277 L 384000.00013614586,6673000.000042274 L 384000.00013613806,6673250.000042227 L 384000.00013613043,6673500.000042183 L 384000.00013612444,6673750.000042143 L 383750.00013617304,6673750.000042152 L 383500.00013622275,6673750.000042157 L 383500.0001362292,6673500.000042198 L 383250.00013627746,6673500.000042206 L 383250.0001362709,6673750.000042162 L 383000.0001363203,6673750.000042166 L 383000.00013631204,6674000.0000421265 L 382750.0001363615,6674000.000042132 L 382750.00013635453,6674250.000042092 L 382500.0001364028,6674250.000042097 L 382250.00013645296,6674250.000042101 L 382250.0001364592,6674000.000042146 L 382000.0001365085,6674000.000042154 L 382000.0001365151,6673750.0000422 L 381750.00013656385,6673750.000042204 L 381500.00013661344,6673750.000042214 L 381500.00013661984,6673500.000042252 L 381500.00013662706,6673250.000042296 L 381250.0001366759,6673250.000042306 L 381250.0001366826,6673000.000042345 z M 371500.00013875595,6667250.000043626 L 371500.0001387641,6667000.000043664 L 371750.00013871514,6667000.0000436595 L 372000.0001386655,6667000.000043651 L 372000.0001386585,6667250.000043609 L 372250.00013860886,6667250.000043599 L 372500.0001385598,6667250.0000435915 L 372500.0001385528,6667500.00004355 L 372250.00013860175,6667500.000043557 L 372000.00013865123,6667500.000043566 L 371750.0001387008,6667500.000043572 L 371750.00013869314,6667750.000043527 L 371500.0001387426,6667750.000043536 L 371500.00013874966,6667500.000043577 L 371500.00013875595,6667250.000043626 z M 379750.00013698987,6672500.000042475 L 379750.00013699796,6672250.000042525 L 380000.0001369481,6672250.000042514 L 380250.00013689965,6672250.0000425065 L 380250.000136906,6672000.000042551 L 380500.0001368574,6672000.000042545 L 380750.0001368086,6672000.000042536 L 381000.000136759,6672000.000042533 L 381000.00013675325,6672250.000042487 L 381000.0001367456,6672500.00004244 L 380750.00013679406,6672500.000042448 L 380750.0001367875,6672750.000042405 L 380500.0001368363,6672750.000042413 L 380500.0001368285,6673000.000042371 L 380500.00013682357,6673250.000042326 L 380250.0001368717,6673250.000042329 L 380250.00013687793,6673000.000042375 L 380250.000136885,6672750.000042418 L 380000.0001369348,6672750.000042424 L 379750.00013698376,6672750.000042437 L 379750.00013698987,6672500.000042475 z M 373250.0001384056,6667500.000043528 L 373250.00013841223,6667250.000043575 L 373500.00013836386,6667250.000043568 L 373500.0001383566,6667500.000043522 L 373250.0001384056,6667500.000043528 z M 390250.0001349182,6673250.0000420585 L 390500.0001348688,6673250.00004205 L 390750.00013482093,6673250.000042043 L 390750.0001348135,6673500.000041999 L 390500.0001348621,6673500.0000420045 L 390250.00013491116,6673500.000042012 L 390250.0001349182,6673250.0000420585 z M 388500.0001351703,6676500.000041539 L 388250.00013521896,6676500.000041549 L 388250.0001352258,6676250.000041592 L 388250.00013523304,6676000.000041637 L 388250.0001352393,6675750.0000416795 L 388250.00013524655,6675500.000041723 L 388250.0001352528,6675250.000041765 L 388500.0001352041,6675250.000041756 L 388500.000135211,6675000.000041801 L 388500.00013521814,6674750.000041843 L 388500.0001352249,6674500.000041888 L 388500.00013523095,6674250.00004193 L 388500.00013523875,6674000.000041975 L 388750.0001351887,6674000.000041969 L 388750.0001351822,6674250.0000419235 L 389000.000135134,6674250.000041914 L 389000.00013512577,6674500.000041871 L 389250.00013507844,6674500.000041865 L 389250.00013507175,6674750.000041822 L 389000.00013512024,6674750.000041832 L 389000.0001351137,6675000.000041784 L 389000.00013510685,6675250.00004174 L 389250.00013505796,6675250.000041734 L 389500.0001350093,6675250.00004173 L 389500.0001350028,6675500.000041688 L 389750.00013495417,6675500.0000416795 L 390000.0001349058,6675500.000041674 L 390000.00013489905,6675750.000041626 L 390000.00013489166,6676000.0000415845 L 390000.00013488566,6676250.000041544 L 390000.00013487734,6676500.0000415 L 390000.0001348711,6676750.000041457 L 389750.00013491977,6676750.000041467 L 389500.0001349686,6676750.00004147 L 389500.0001349757,6676500.000041516 L 389750.00013492705,6676500.000041506 L 389750.00013493345,6676250.000041547 L 389500.00013498234,6676250.0000415575 L 389500.00013498944,6676000.000041598 L 389250.0001350381,6676000.000041609 L 389000.00013508584,6676000.000041612 L 388750.00013513514,6676000.000041621 L 388500.0001351834,6676000.000041625 L 388500.0001351777,6676250.0000415845 L 388500.0001351703,6676500.000041539 z M 390000.00013491174,6675250.000041716 L 390250.0001348642,6675250.000041709 L 390250.00013485603,6675500.000041666 L 390000.0001349058,6675500.000041674 L 390000.00013491174,6675250.000041716 z M 392750.0001345058,6670500.000042463 L 392500.00013455487,6670500.000042469 L 392250.0001346031,6670500.000042477 L 392250.0001346103,6670250.000042522 L 392500.0001345611,6670250.000042514 L 392750.00013451296,6670250.000042509 L 392750.0001345058,6670500.000042463 z M 392750.000134519,6670000.00004255 L 393000.0001344706,6670000.000042542 L 393250.0001344221,6670000.000042537 L 393250.000134415,6670250.000042495 L 393000.00013446406,6670250.000042502 L 392750.00013451296,6670250.000042509 L 392750.000134519,6670000.00004255 z M 395000.0001339322,6675500.000041536 L 395000.0001339251,6675750.000041492 L 394750.00013397424,6675750.0000415025 L 394750.0001339805,6675500.000041541 L 395000.0001339322,6675500.000041536 z M 401000.00013266667,6679250.000040724 L 401000.0001326736,6679000.00004077 L 401250.0001326245,6679000.000040764 L 401250.0001326187,6679250.000040721 L 401000.00013266667,6679250.000040724 z\" /><path fill-rule=\"evenodd\" fill=\"#66cc99\" stroke=\"#555555\" stroke-width=\"304.1999999391699\" opacity=\"0.6\" d=\"M 371250.000138855,6665500.000043934 L 371000.00013890443,6665500.000043943 L 371000.00013889704,6665750.000043898 L 371250.0001388481,6665750.000043889 L 371500.00013879914,6665750.000043883 L 371500.00013880595,6665500.000043924 L 371250.000138855,6665500.000043934 z\" /><path fill-rule=\"evenodd\" fill=\"#66cc99\" stroke=\"#555555\" stroke-width=\"304.1999999391699\" opacity=\"0.6\" d=\"M 387250.00013559195,6670000.000042703 L 387500.0001355434,6670000.0000426965 L 387750.00013549556,6670000.000042687 L 388000.00013544573,6670000.000042682 L 388250.00013539626,6670000.000042673 L 388250.0001354041,6669750.000042717 L 388500.00013535516,6669750.00004271 L 388750.0001353063,6669750.000042703 L 388750.0001353131,6669500.000042747 L 388750.0001353197,6669250.000042791 L 388750.00013532594,6669000.000042834 L 388500.00013537577,6669000.000042844 L 388500.0001353825,6668750.000042885 L 388500.000135389,6668500.0000429265 L 388500.0001353964,6668250.00004297 L 388250.0001354444,6668250.000042978 L 388000.00013549364,6668250.000042984 L 388000.0001354867,6668500.0000429405 L 388000.0001354803,6668750.0000428995 L 387750.00013552845,6668750.000042902 L 387750.0001355219,6669000.00004286 L 387500.00013557024,6669000.000042869 L 387500.00013556454,6669250.000042829 L 387250.0001356133,6669250.000042833 L 387250.0001356061,6669500.000042788 L 387250.00013559946,6669750.000042746 L 387250.00013559195,6670000.000042703 z\" /></g></g></svg>"
      ],
      "text/plain": [
       "<shapely.geometry.multipolygon.MultiPolygon at 0x20b60405670>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Polygon centroids\n",
    "data.unary_union"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7584c825-8be2-486b-87f8-13add35eee89",
   "metadata": {},
   "source": [
    "Note that the previous operation is identical to calling `data['geometry'].unary_union`."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b36ec0ac",
   "metadata": {},
   "source": [
    "## Data extent\n",
    "\n",
    "Sometimes it is enough to describe the approximate extent of the data using a bounding polygon."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "83e4d86c-c9a0-4ee2-bdc0-72845faa4158",
   "metadata": {},
   "source": [
    "### Bounding box\n",
    "\n",
    "A minimum bounding rectangle, i.e. a bounding box or an envelope is the smallest rectangular polygon surrounding a geometric object. In a GeoDataFrame, the `envelope` attribute returns the bounding rectangle for each geometry:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "8c0513d4-03c8-42d1-917d-aaf43c5dab38",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0        POLYGON ((381750.000 6697750.000, 382000.000 6...\n",
       "1        POLYGON ((382000.000 6697750.000, 382250.000 6...\n",
       "2        POLYGON ((382250.000 6697750.000, 382500.000 6...\n",
       "3        POLYGON ((382500.000 6697750.000, 382750.000 6...\n",
       "4        POLYGON ((381000.000 6697500.000, 381250.000 6...\n",
       "                               ...                        \n",
       "13226    POLYGON ((372750.000 6665500.000, 373000.000 6...\n",
       "13227    POLYGON ((373000.000 6665500.000, 373250.000 6...\n",
       "13228    POLYGON ((372250.000 6665250.000, 372500.000 6...\n",
       "13229    POLYGON ((372500.000 6665250.000, 372750.000 6...\n",
       "13230    POLYGON ((372750.000 6665250.000, 373000.000 6...\n",
       "Length: 13231, dtype: geometry"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.envelope"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4edd8c53-c564-491b-b21a-bbc98b070a58",
   "metadata": {},
   "source": [
    "In order to get the bounding rectangle for the whole layer, we can first create an union of all geometries, and then create the bounding rectangle for those:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "dd2eb312",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"300\" height=\"300\" viewBox=\"359810.0001407551 6663560.000044268 45629.99999087548 36129.99999341555\" preserveAspectRatio=\"xMinYMin meet\"><g transform=\"matrix(1,0,0,-1,0,13363250.00008195)\"><path fill-rule=\"evenodd\" fill=\"#66cc99\" stroke=\"#555555\" stroke-width=\"304.1999999391699\" opacity=\"0.6\" d=\"M 361500.00014041713,6665250.00004393 L 403750.0001319685,6665250.00004393 L 403750.0001319685,6698000.000038021 L 361500.00014041713,6698000.000038021 L 361500.00014041713,6665250.00004393 z\" /></g></svg>"
      ],
      "text/plain": [
       "<shapely.geometry.polygon.Polygon at 0x20b60405520>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.unary_union.envelope"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "acd68be9-1145-46ca-94cb-935eb00c59b0",
   "metadata": {},
   "source": [
    "Corner coordinates of a GeoDataFrame can be directly fetched via the `total_bounds`attribute, while the `bounds` attribute returns the bounding coordinates of each feature:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "f19b82ec-97bf-4264-950e-b91fa7d22ca7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([ 361500.00014042, 6665250.00004393,  403750.00013197,\n",
       "       6698000.00003802])"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.total_bounds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "c73aee97-3941-4faa-954d-850f9c34ae83",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>minx</th>\n",
       "      <th>miny</th>\n",
       "      <th>maxx</th>\n",
       "      <th>maxy</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>381750.000136</td>\n",
       "      <td>6.697750e+06</td>\n",
       "      <td>382000.000136</td>\n",
       "      <td>6.698000e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>382000.000136</td>\n",
       "      <td>6.697750e+06</td>\n",
       "      <td>382250.000136</td>\n",
       "      <td>6.698000e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>382250.000136</td>\n",
       "      <td>6.697750e+06</td>\n",
       "      <td>382500.000136</td>\n",
       "      <td>6.698000e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>382500.000136</td>\n",
       "      <td>6.697750e+06</td>\n",
       "      <td>382750.000136</td>\n",
       "      <td>6.698000e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>381000.000136</td>\n",
       "      <td>6.697500e+06</td>\n",
       "      <td>381250.000136</td>\n",
       "      <td>6.697750e+06</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            minx          miny           maxx          maxy\n",
       "0  381750.000136  6.697750e+06  382000.000136  6.698000e+06\n",
       "1  382000.000136  6.697750e+06  382250.000136  6.698000e+06\n",
       "2  382250.000136  6.697750e+06  382500.000136  6.698000e+06\n",
       "3  382500.000136  6.697750e+06  382750.000136  6.698000e+06\n",
       "4  381000.000136  6.697500e+06  381250.000136  6.697750e+06"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.bounds.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5c3bda05-d74d-4358-88f4-0beb7a71f4a7",
   "metadata": {},
   "source": [
    "### Convex hull\n",
    "\n",
    "A bit more detailed delineation of the data extent can be extracted using a convex hull which represents the smalles possible polygon that contains all points in an object. \n",
    "\n",
    "In order to create a covex hull for all grid squares, in stead of individual grid squares, we need to first create an union of all polygons: "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "8a81a3c2-f4f2-423e-9737-d5030d1cbe96",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"300\" height=\"300\" viewBox=\"359810.0001407551 6663560.000044268 45629.99999087548 36129.99999341555\" preserveAspectRatio=\"xMinYMin meet\"><g transform=\"matrix(1,0,0,-1,0,13363250.00008195)\"><path fill-rule=\"evenodd\" fill=\"#66cc99\" stroke=\"#555555\" stroke-width=\"304.1999999391699\" opacity=\"0.6\" d=\"M 373000.00013851776,6665250.00004393 L 372750.0001385672,6665250.000043934 L 372250.0001386649,6665250.000043948 L 371000.00013890443,6665500.000043943 L 362250.0001403382,6675750.000042403 L 361500.0001404374,6677500.000042123 L 361500.00014042354,6678000.000042033 L 361500.00014041713,6678250.00004199 L 361750.0001400259,6690500.000039859 L 369000.0001385063,6694000.000039055 L 381750.00013590575,6698000.000038021 L 382500.0001357596,6698000.000038004 L 382750.0001357113,6698000.000037992 L 394500.0001335142,6694750.000038238 L 398250.0001328343,6693000.000038436 L 403750.0001319627,6685750.000039535 L 403750.0001319685,6685500.00003958 L 403500.0001320834,6683000.000040014 L 402750.00013228826,6680750.000040423 L 402500.0001323506,6680250.000040516 L 402000.0001324732,6679250.000040699 L 399250.000133147,6674000.000041679 L 393750.00013435184,6669000.000042696 L 392500.00013462343,6668000.000042901 L 391000.00013492256,6667750.00004299 L 373000.00013851776,6665250.00004393 z\" /></g></svg>"
      ],
      "text/plain": [
       "<shapely.geometry.polygon.Polygon at 0x20b5d996610>"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.unary_union.convex_hull"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a6df7c4e-2df9-4d76-aa9f-0b6927697d3f",
   "metadata": {},
   "source": [
    "## Buffer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "045169e9-b23e-4165-b5be-f27dd167aadf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"300\" height=\"300\" viewBox=\"354410.0001404 6658160.0000404 56429.999989199976 46929.999999200925\" preserveAspectRatio=\"xMinYMin meet\"><g transform=\"matrix(1,0,0,-1,0,13363250.00008)\"><path fill-rule=\"evenodd\" fill=\"#66cc99\" stroke=\"#555555\" stroke-width=\"376.19999992799984\" opacity=\"0.6\" d=\"M 356775.54716,6685250.00004 L 356774.07651,6685259.91434 L 356750.00014,6685750.00004 L 356750.00014,6686000.00004 L 356750.00014,6686250.00004 L 356774.07651,6686740.08574 L 356846.07374,6687225.45165 L 356965.29846,6687701.42343 L 357008.70811,6687822.74527 L 357000.00014,6688000.00004 L 357000.00014,6688250.00004 L 357000.00014,6688451.59195 L 356965.29846,6688548.57665 L 356846.07374,6689024.54843 L 356774.07651,6689509.91434 L 356750.00014,6690000.00004 L 356750.00014,6690250.00004 L 356750.00014,6690500.00004 L 356774.07651,6690990.08574 L 356846.07374,6691475.45165 L 356965.29846,6691951.42343 L 357130.60248,6692413.4172 L 357340.39382,6692856.98372 L 357592.65208,6693277.8512 L 357884.94787,6693671.96646 L 358214.46623,6694035.53395 L 358578.03372,6694365.05231 L 358972.14897,6694657.3481 L 359393.01646,6694909.60636 L 359836.58298,6695119.3977 L 360298.57675,6695284.70172 L 360774.54853,6695403.92644 L 361259.91444,6695475.92367 L 361750.00014,6695500.00004 L 362000.00014,6695500.00004 L 362250.00014,6695500.00004 L 362740.08584,6695475.92367 L 363225.45175,6695403.92644 L 363701.42353,6695284.70172 L 363903.56296,6695212.37507 L 363904.4869,6695213.91657 L 364090.39382,6695606.98372 L 364154.4869,6695713.91657 L 364340.39382,6696106.98372 L 364592.65208,6696527.8512 L 364884.94787,6696921.96646 L 365214.46623,6697285.53395 L 365345.60712,6697404.39312 L 365464.46623,6697535.53394 L 365828.03372,6697865.05231 L 366222.14897,6698157.3481 L 366643.01645,6698409.60636 L 367086.58298,6698619.3977 L 367548.57675,6698784.70172 L 368024.54853,6698903.92644 L 368509.91444,6698975.92367 L 369000.00014,6699000.00004 L 369201.59205,6699000.00004 L 369298.57675,6699034.70172 L 369774.54853,6699153.92644 L 370259.91444,6699225.92367 L 370750.00014,6699250.00004 L 371000.00014,6699250.00004 L 371250.00014,6699250.00004 L 371500.00014,6699250.00004 L 371750.00014,6699250.00004 L 372240.08584,6699225.92367 L 372725.45175,6699153.92644 L 373201.42352,6699034.70172 L 373663.4173,6698869.3977 L 374106.98382,6698659.60636 L 374522.388,6698410.62267 L 374592.65208,6698527.8512 L 374884.94787,6698921.96646 L 375214.46623,6699285.53394 L 375345.60709,6699404.39309 L 375414.11469,6699479.97958 L 375592.65207,6699777.8512 L 375884.94787,6700171.96646 L 376214.46623,6700535.53394 L 376345.60709,6700654.39309 L 376464.46623,6700785.53394 L 376595.60709,6700904.39309 L 376714.46623,6701035.53394 L 377078.03372,6701365.0523 L 377472.14897,6701657.3481 L 377893.01645,6701909.60636 L 378336.58297,6702119.3977 L 378798.57675,6702284.70172 L 379030.15407,6702342.70882 L 379086.58297,6702369.3977 L 379548.57675,6702534.70172 L 379780.15407,6702592.70882 L 379836.58297,6702619.3977 L 380298.57675,6702784.70172 L 380774.54853,6702903.92644 L 381259.91443,6702975.92367 L 381750.00014,6703000.00004 L 382000.00014,6703000.00004 L 382250.00014,6703000.00004 L 382500.00014,6703000.00004 L 382750.00014,6703000.00004 L 383240.08584,6702975.92367 L 383725.45175,6702903.92644 L 384201.42352,6702784.70172 L 384663.4173,6702619.3977 L 385106.98382,6702409.60636 L 385527.8513,6702157.3481 L 385921.96656,6701865.0523 L 386285.53404,6701535.53394 L 386615.0524,6701171.96646 L 386907.3482,6700777.8512 L 387159.60646,6700356.98372 L 387369.3978,6699913.4172 L 387534.70181,6699451.42342 L 387653.92654,6698975.45165 L 387694.09636,6698704.64869 L 387784.70181,6698451.42342 L 387810.3511,6698349.02573 L 387828.03371,6698365.05231 L 388222.14897,6698657.3481 L 388643.01645,6698909.60636 L 389086.58297,6699119.3977 L 389548.57675,6699284.70172 L 390024.54852,6699403.92644 L 390509.91443,6699475.92367 L 390943.88781,6699497.24342 L 391048.57675,6699534.70172 L 391524.54852,6699653.92644 L 392009.91443,6699725.92367 L 392500.00013,6699750.00004 L 392750.00013,6699750.00004 L 393000.00013,6699750.00004 L 393375.00013,6699731.57747 L 393750.00013,6699750.00004 L 394000.00013,6699750.00004 L 394250.00013,6699750.00004 L 394500.00013,6699750.00004 L 394990.08584,6699725.92367 L 395475.45174,6699653.92644 L 395951.42352,6699534.70172 L 396413.4173,6699369.3977 L 396856.98382,6699159.60636 L 397277.8513,6698907.3481 L 397671.96655,6698615.05231 L 397799.23262,6698499.70506 L 398163.4173,6698369.3977 L 398606.98382,6698159.60636 L 398970.45164,6697941.75213 L 399225.45174,6697903.92644 L 399701.42352,6697784.70172 L 400163.41729,6697619.3977 L 400606.98382,6697409.60636 L 401027.8513,6697157.3481 L 401421.96655,6696865.05231 L 401785.53404,6696535.53394 L 402115.0524,6696171.96646 L 402407.34819,6695777.8512 L 402659.60645,6695356.98372 L 402869.3978,6694913.4172 L 403034.70181,6694451.42342 L 403153.92653,6693975.45165 L 403225.92377,6693490.08574 L 403250.00013,6693000.00004 L 403250.00013,6692750.00004 L 403225.92377,6692259.91434 L 403205.91112,6692125.00004 L 403225.92377,6691990.08574 L 403250.00013,6691500.00004 L 403250.00013,6691250.00004 L 403250.00013,6691000.00004 L 403500.00013,6691000.00004 L 403990.08583,6690975.92367 L 404475.45174,6690903.92644 L 404951.42352,6690784.70172 L 405413.41729,6690619.3977 L 405856.98382,6690409.60636 L 406277.8513,6690157.3481 L 406671.96655,6689865.05231 L 407035.53404,6689535.53395 L 407154.39318,6689404.39309 L 407285.53404,6689285.53395 L 407615.0524,6688921.96646 L 407907.34819,6688527.8512 L 408159.60645,6688106.98372 L 408369.39779,6687663.4172 L 408534.70181,6687201.42343 L 408653.92653,6686725.45165 L 408725.92377,6686240.08574 L 408750.00013,6685750.00004 L 408750.00013,6685500.00004 L 408725.92377,6685009.91434 L 408653.92653,6684524.54843 L 408534.70181,6684048.57665 L 408480.49316,6683897.07363 L 408500.00013,6683500.00004 L 408500.00013,6683250.00004 L 408500.00013,6683000.00004 L 408475.92377,6682509.91434 L 408403.92653,6682024.54843 L 408284.70181,6681548.57665 L 408119.39779,6681086.58288 L 407909.60645,6680643.01636 L 407730.02532,6680343.40334 L 407725.92377,6680259.91434 L 407653.92653,6679774.54843 L 407534.70181,6679298.57665 L 407369.39779,6678836.58288 L 407159.60645,6678393.01636 L 407095.51337,6678286.08351 L 406909.60645,6677893.01636 L 406683.53907,6677515.84572 L 406619.3978,6677336.58288 L 406409.60645,6676893.01636 L 406157.34819,6676472.14888 L 405865.0524,6676078.03362 L 405535.53404,6675714.46613 L 405416.03182,6675606.15563 L 405403.92653,6675524.54843 L 405284.70181,6675048.57666 L 405119.3978,6674586.58288 L 404909.60645,6674143.01636 L 404657.34819,6673722.14888 L 404537.80434,6673560.96265 L 404534.70181,6673548.57666 L 404369.3978,6673086.58288 L 404159.60645,6672643.01636 L 403933.53906,6672265.84571 L 403869.3978,6672086.58288 L 403659.60645,6671643.01636 L 403407.34819,6671222.14888 L 403115.0524,6670828.03362 L 402785.53404,6670464.46614 L 402421.96655,6670134.94777 L 402027.8513,6669842.65198 L 401606.98382,6669590.39372 L 401163.41729,6669380.60238 L 400701.42352,6669215.29836 L 400689.03751,6669212.19583 L 400527.8513,6669092.65198 L 400106.98382,6668840.39372 L 399663.4173,6668630.60238 L 399201.42352,6668465.29836 L 398759.70323,6668354.65319 L 398676.93405,6668179.65247 L 398653.92654,6668024.54843 L 398534.70181,6667548.57666 L 398369.3978,6667086.58288 L 398159.60646,6666643.01636 L 397907.3482,6666222.14888 L 397615.0524,6665828.03362 L 397285.53404,6665464.46614 L 396921.96656,6665134.94778 L 396527.8513,6664842.65198 L 396229.97968,6664664.1146 L 396154.39318,6664595.607 L 396035.53404,6664464.46614 L 395671.96656,6664134.94778 L 395277.8513,6663842.65198 L 394856.98382,6663590.39372 L 394413.4173,6663380.60238 L 393951.42352,6663215.29836 L 393475.45174,6663096.07364 L 392990.08584,6663024.07641 L 392556.11246,6663002.75666 L 392451.42352,6662965.29836 L 391975.45174,6662846.07364 L 391490.08584,6662774.07641 L 391000.00013,6662750.00004 L 390750.00013,6662750.00004 L 390500.00013,6662750.00004 L 390009.91443,6662774.07641 L 389524.54852,6662846.07364 L 389048.57675,6662965.29836 L 388586.58297,6663130.60238 L 388334.13783,6663250.00004 L 388250.00014,6663250.00004 L 388000.00014,6663250.00004 L 387509.91443,6663274.07641 L 387024.54853,6663346.07364 L 386548.57675,6663465.29836 L 386086.58297,6663630.60238 L 385643.01645,6663840.39372 L 385222.14897,6664092.65198 L 384828.03371,6664384.94778 L 384701.0931,6664500.00004 L 384548.40822,6664500.00004 L 384451.42352,6664465.29836 L 383975.45175,6664346.07364 L 383490.08584,6664274.07641 L 383000.00014,6664250.00004 L 382750.00014,6664250.00004 L 382500.00014,6664250.00004 L 382250.00014,6664250.00004 L 382000.00014,6664250.00004 L 381750.00014,6664250.00004 L 381259.91443,6664274.07641 L 380774.54853,6664346.07364 L 380298.57675,6664465.29836 L 379836.58297,6664630.60238 L 379393.01645,6664840.39372 L 379283.8936,6664905.79944 L 379159.60646,6664643.01636 L 378907.3482,6664222.14888 L 378615.0524,6663828.03362 L 378335.88558,6663520.0205 L 378157.3482,6663222.14888 L 377865.05241,6662828.03362 L 377535.53404,6662464.46614 L 377171.96656,6662134.94778 L 376777.8513,6661842.65198 L 376479.97968,6661664.1146 L 376171.96656,6661384.94778 L 375777.8513,6661092.65198 L 375356.98382,6660840.39372 L 374913.4173,6660630.60238 L 374451.42352,6660465.29837 L 373975.45175,6660346.07364 L 373490.08584,6660274.07641 L 373000.00014,6660250.00004 L 372750.00014,6660250.00004 L 372500.00014,6660250.00004 L 372250.00014,6660250.00004 L 371759.91444,6660274.07641 L 371274.54853,6660346.07364 L 370798.57675,6660465.29837 L 370654.09984,6660516.99303 L 370509.91444,6660524.07641 L 370024.54853,6660596.07364 L 369548.57675,6660715.29837 L 369086.58298,6660880.60238 L 368643.01645,6661090.39372 L 368222.14897,6661342.65198 L 367828.03372,6661634.94778 L 367464.46623,6661964.46614 L 367134.94787,6662328.03362 L 366842.65208,6662722.14888 L 366590.39382,6663143.01636 L 366380.60248,6663586.58288 L 366316.46122,6663765.84569 L 366090.39382,6664143.01636 L 365904.4869,6664536.08351 L 365840.39382,6664643.01636 L 365659.86813,6665024.70586 L 365476.74791,6665226.74789 L 365214.46623,6665464.46614 L 364884.94787,6665828.03362 L 364592.65208,6666222.14888 L 364340.39382,6666643.01636 L 364196.74223,6666946.74213 L 363893.01646,6667090.39372 L 363472.14897,6667342.65198 L 363078.03372,6667634.94778 L 362714.46623,6667964.46614 L 362595.60707,6668095.60701 L 362464.46623,6668214.46614 L 362134.94787,6668578.03362 L 361842.65208,6668972.14888 L 361605.73041,6669367.42881 L 361342.65208,6669722.14888 L 361108.99159,6670111.98786 L 361078.03372,6670134.94778 L 360714.46623,6670464.46614 L 360384.94787,6670828.03362 L 360360.71199,6670860.71192 L 360328.03372,6670884.94778 L 360020.02058,6671164.11461 L 359722.14898,6671342.65198 L 359328.03372,6671634.94778 L 358964.46623,6671964.46614 L 358845.60707,6672095.60701 L 358714.46623,6672214.46614 L 358384.94787,6672578.03362 L 358092.65208,6672972.14888 L 357840.39382,6673393.01636 L 357630.60248,6673836.58288 L 357465.29846,6674298.57666 L 357367.63793,6674688.45936 L 357342.65208,6674722.14888 L 357090.39382,6675143.01636 L 356880.60248,6675586.58288 L 356715.29846,6676048.57666 L 356596.07374,6676524.54843 L 356524.07651,6677009.91434 L 356500.00014,6677500.00004 L 356500.00014,6677750.00004 L 356500.00014,6678000.00004 L 356500.00014,6678250.00004 L 356524.07651,6678740.08574 L 356596.07374,6679225.45165 L 356715.29846,6679701.42343 L 356880.60248,6680163.4172 L 357058.2038,6680538.92364 L 356965.29846,6680798.57665 L 356846.07374,6681274.54843 L 356774.07651,6681759.91434 L 356750.00014,6682250.00004 L 356750.00014,6682500.00004 L 356750.00014,6682750.00004 L 356750.00014,6683000.00004 L 356750.00014,6683250.00004 L 356750.00014,6683500.00004 L 356750.00014,6683750.00004 L 356750.00014,6684000.00004 L 356750.00014,6684250.00004 L 356750.00014,6684500.00004 L 356750.00014,6684750.00004 L 356774.07651,6685240.08574 L 356775.54716,6685250.00004 z\" /></g></svg>"
      ],
      "text/plain": [
       "<shapely.geometry.polygon.Polygon at 0x20b603e8eb0>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 5 km buffer for the travel time matrix extent\n",
    "data.unary_union.buffer(5000)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "05e5f7e9",
   "metadata": {},
   "source": [
    "\n",
    "\n",
    "## Dissolving and merging geometries\n",
    "\n",
    "Data aggregation refers to a process where we combine data into groups. When doing spatial data aggregation, we merge the geometries together into coarser units (based on some attribute), and can also calculate summary statistics for these combined geometries from the original, more detailed values. For example, suppose that we are interested in studying continents, but we only have country-level data like the country dataset. If we aggregate the data by continent, we would convert the country-level data into a continent-level dataset.\n",
    "\n",
    "In this section, we will aggregate our travel time data by car travel times (column `car_r_t`), i.e. the grid cells that have the same travel time to Railway Station will be merged together.\n",
    "\n",
    "- For doing the aggregation we will use a function called `dissolve()` that takes as input the column that will be used for conducting the aggregation:\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f1ddc1d7",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Conduct the aggregation\n",
    "dissolved = intersection.dissolve(by=\"car_r_t\")\n",
    "\n",
    "# What did we get\n",
    "dissolved.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "152bde89",
   "metadata": {},
   "source": [
    "- Let's compare the number of cells in the layers before and after the aggregation:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0976aa20",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(\"Rows in original intersection GeoDataFrame:\", len(intersection))\n",
    "print(\"Rows in dissolved layer:\", len(dissolved))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "194b621b",
   "metadata": {},
   "source": [
    "Indeed the number of rows in our data has decreased and the Polygons were merged together.\n",
    "\n",
    "What actually happened here? Let's take a closer look. \n",
    "\n",
    "- Let's see what columns we have now in our GeoDataFrame:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "517500ed",
   "metadata": {},
   "outputs": [],
   "source": [
    "dissolved.columns"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c68b18fd",
   "metadata": {},
   "source": [
    "As we can see, the column that we used for conducting the aggregation (`car_r_t`) can not be found from the columns list anymore. What happened to it?\n",
    "\n",
    "- Let's take a look at the indices of our GeoDataFrame:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "32fa4a1c",
   "metadata": {},
   "outputs": [],
   "source": [
    "dissolved.index"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "97133b03",
   "metadata": {},
   "source": [
    "Aha! Well now we understand where our column went. It is now used as index in our `dissolved` GeoDataFrame. \n",
    "\n",
    "- Now, we can for example select only such geometries from the layer that are for example exactly 15 minutes away from the Helsinki Railway Station:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6aa6cf43",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Select only geometries that are within 15 minutes away\n",
    "dissolved.loc[15]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c8b12863",
   "metadata": {},
   "outputs": [],
   "source": [
    "# See the data type\n",
    "type(dissolved.loc[15])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7c66bda8",
   "metadata": {},
   "outputs": [],
   "source": [
    "# See the data\n",
    "dissolved.loc[15].head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "68918dff",
   "metadata": {},
   "source": [
    "As we can see, as a result, we have now a Pandas `Series` object containing basically one row from our original aggregated GeoDataFrame.\n",
    "\n",
    "Let's also visualize those 15 minute grid cells.\n",
    "\n",
    "- First, we need to convert the selected row back to a GeoDataFrame:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d72a88c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create a GeoDataFrame\n",
    "selection = gpd.GeoDataFrame([dissolved.loc[15]], crs=dissolved.crs)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "772b207f",
   "metadata": {},
   "source": [
    "- Plot the selection on top of the entire grid:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "40045aa0",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Plot all the grid cells, and the grid cells that are 15 minutes a way from the Railway Station\n",
    "ax = dissolved.plot(facecolor=\"gray\")\n",
    "selection.plot(ax=ax, facecolor=\"red\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d07187be-cb7b-44c0-8a7f-519fb4abe0bb",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "a6694453-7486-4da7-bc72-a5a618b235aa",
   "metadata": {},
   "source": [
    "## Simplifying geometries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0df8ef9f-1c05-4618-be22-c006f5fc914b",
   "metadata": {},
   "outputs": [],
   "source": [
    "data.unary_union.simplify(tolerance=500)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "43ae3595",
   "metadata": {},
   "source": [
    "## Simplifying geometries\n",
    "\n",
    "Sometimes it might be useful to be able to simplify geometries. This could be something to consider for example when you have very detailed spatial features that cover the whole world. If you make a map that covers the whole world, it is unnecessary to have really detailed geometries because it is simply impossible to see those small details from your map. Furthermore, it takes a long time to actually render a large quantity of features into a map. Here, we will see how it is possible to simplify geometric features in Python.\n",
    "\n",
    "As an example we will use data representing the Amazon river in South America, and simplify it's geometries.\n",
    "\n",
    "- Let's first read the data and see how the river looks like:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "aa9964f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "import geopandas as gpd\n",
    "\n",
    "# File path\n",
    "fp = \"data/Amazon_river.shp\"\n",
    "data = gpd.read_file(fp)\n",
    "\n",
    "# Print crs\n",
    "print(data.crs)\n",
    "\n",
    "# Plot the river\n",
    "data.plot()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e26624fc",
   "metadata": {},
   "source": [
    "The LineString that is presented here is quite detailed, so let's see how we can generalize them a bit. As we can see from the coordinate reference system, the data is projected in a metric system using [Mercator projection based on SIRGAS datum](http://spatialreference.org/ref/sr-org/7868/). \n",
    "\n",
    "- Generalization can be done easily by using a Shapely function called `.simplify()`. The `tolerance` parameter can be used to adjusts how much geometries should be generalized. **The tolerance value is tied to the coordinate system of the geometries**. Hence, the value we pass here is 20 000 **meters** (20 kilometers)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d102a662",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Generalize geometry\n",
    "data[\"geom_gen\"] = data.simplify(tolerance=20000)\n",
    "\n",
    "# Set geometry to be our new simlified geometry\n",
    "data = data.set_geometry(\"geom_gen\")\n",
    "\n",
    "# Plot\n",
    "data.plot()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8a5a7dad",
   "metadata": {},
   "source": [
    "Nice! As a result, now we have simplified our LineString quite significantly as we can see from the map.\n",
    "\n",
    "\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
